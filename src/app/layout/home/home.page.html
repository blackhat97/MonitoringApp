<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
        <ion-title>
        {{title}}
        </ion-title>
        <ion-buttons slot="end">
            <ion-button (click)="presentFilter()">
                <ion-icon slot="icon-only" name="options"></ion-icon>
            </ion-button>
            <ion-button (click)="presentNoti()">
                <ion-icon name="notifications"></ion-icon>
                <ion-badge id="notifications-badge" color="danger" [hidden]="badgeNumber == 0">{{badgeNumber}}</ion-badge>
            </ion-button>
        </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
    <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
        <ion-refresher-content pullingIcon="arrow-dropdown" pullingText="새로고침 중"
            refreshingSpinner="crescent">
        </ion-refresher-content>
    </ion-refresher>

        <ion-slides #slider>
            <ion-slide *ngFor="let channel of channels">
            <ion-grid>
                <ion-row>
                    <ion-text class="channel__text">{{channel.ch_name}}</ion-text>
                </ion-row>
                <ion-row>
                    <ion-col no-padding size="12" size-md="6" *ngFor="let sensor of sensors; let i = index">  

                        <ion-card no-padding *ngIf="(sensor.channel_id == channel.id) && (modes[i] == 0)" class="gauge-card" (click)="changeMode(i, 1)">
                                
                                <ion-list [attr.track]="sensor.state">
                                    <ion-list-header>
                                        <ion-label item-start text-left color="dark">{{ sensor.name_tag }}</ion-label>
                                        <ion-label item-end text-right>{{sensor.temp}}°C</ion-label>
                                    </ion-list-header>
                                    
                                    <ion-row>
                                        <ion-col align-self-end>
                                            <ng-container [ngSwitch]="sensor.state">
                                                <div *ngSwitchCase="00">
                                                    <ion-label color="dark" style="font-size: 14px;">{{MSG_OK}}</ion-label>
                                                </div>
                                                <div *ngSwitchCase="02">
                                                    <ion-label color="dark" style="font-size: 14px;">{{MSG_NETWORK_ERROR}}</ion-label>
                                                </div>
                                                <div *ngSwitchCase="03">
                                                    <ion-label color="dark" style="font-size: 14px;">{{MSG_CORRECTION}}</ion-label>
                                                </div>
                                                <div *ngSwitchCase="04">
                                                    <ion-label color="dark" style="font-size: 14px;">{{MSG_REPLACE}}</ion-label>
                                                </div>
                                                <div *ngSwitchCase="06">
                                                    <ion-label color="dark" style="font-size: 14px;">{{MSG_TROUBLE}}</ion-label>
                                                </div>
                                                <div *ngSwitchCase="07">
                                                    <ion-label color="dark" style="font-size: 14px;">{{MSG_CLEAN}}</ion-label>
                                                </div>
                                                <div *ngSwitchDefault>
                                                    <ion-label></ion-label>
                                                </div>
                                            </ng-container>
                                        </ion-col>
                                        <ion-col>
                                            <ion-label text-right color="dark" class="sensor-value">{{ sensor.value }}</ion-label>
                                            &nbsp;{{ sensor.unit }}
                                        </ion-col>
                                    </ion-row>
                                </ion-list>
                        </ion-card>
                        
                        <ion-card *ngIf="(sensor.channel_id == channel.id) && (modes[i] == 1)" class="button-card">
                            <ion-card-content style="top: 25%;">
                                <ion-buttons>
                                    <ion-button class="button__list" fill="outline" expand="block" (click)="changeMode(i, 2)">       
                                        <div>
                                            <ion-icon style="zoom:1.5;" name="speedometer"></ion-icon><br>
                                            <ion-label>아날로그<br />표시창</ion-label>
                                        </div>
                                    </ion-button>
                                    <ion-button class="button__list" fill="outline" expand="block" (click)="changeMode(i, 3, sensor.id)">
                                        <div>
                                            <ion-icon style="zoom:1.5;" name="pulse"></ion-icon><br>
                                            <ion-label>트렌드<br />보기</ion-label>
                                        </div>
                                    </ion-button>
                                    <ion-button class="button__list" fill="outline" expand="block" [routerLink]="'/view-source/trend/' + sensor.id" routerDirection="forward">
                                        <div>
                                            <ion-icon style="zoom:1.5;" name="paper"></ion-icon><br>
                                            <ion-label>자료<br />보기</ion-label>
                                        </div>
                                    </ion-button>
                                    <ion-button class="button__list" fill="outline" expand="block" [routerLink]="'/settings/' + sensor.id" routerDirection="forward">
                                        <div>
                                            <ion-icon style="zoom:1.5;" name="settings"></ion-icon><br>
                                            <ion-label>설정</ion-label>
                                        </div>
                                    </ion-button>
                                    <ion-button class="button__list" fill="outline" expand="block" (click)="changeMode(i, 0)">
                                        <div>
                                            <ion-icon style="zoom:1.5;" name="home"></ion-icon><br>
                                            <ion-label>메인<br />화면</ion-label>
                                        </div>
                                    </ion-button>
                                </ion-buttons>
                            </ion-card-content>
                        </ion-card>
                        
                        <ion-card *ngIf="((sensor.channel_id == channel.id) && (modes[i] == 2))" class="button-card" (click)="changeMode(i, 1)">

                            <ion-card-content>
                                    <!--
                                    <ion-list-header>
                                        <ion-label item-start text-left color="dark">{{ sensor.name_tag }}</ion-label>
                                        <ion-label item-end text-right>{{sensor.temp}}°C</ion-label>
                                    </ion-list-header>
                                    -->
                                    <ion-row>
                                        <ion-col align-self-end>
                                            <ion-row>
                                                <linear-gauge #linear_gauge
                                                width="150"
                                                height="50"
                                                minor-ticks="4"
                                                stroke-ticks="true"
                                                color-plate="#fff"
                                                border-shadow-width="0"
                                                font-numbers-size="40"
                                                borders="false"
                                                bar-begin-circle="false"
                                                tick-side="left"
                                                number-side="left"
                                                needle-side="left"
                                                needle-type="line"
                                                ticks-width="50"
                                                ticks-width-minor="15"
                                                needle-width="10"
                                                color-needle="#888888"
                                                color-needle-end="#888888"
                                                bar-width="20"
                                                value="{{sensor.value}}"
                                                >
                                                </linear-gauge>
                                            </ion-row>
                                            <ion-row>
                                                <ng-container [ngSwitch]="sensor.state">
                                                    <div *ngSwitchCase="00">
                                                        <ion-label color="dark" style="font-size: 14px;">{{MSG_OK}}</ion-label>
                                                    </div>
                                                    <div *ngSwitchCase="02">
                                                        <ion-label color="dark" style="font-size: 14px;">{{MSG_NETWORK_ERROR}}</ion-label>
                                                    </div>
                                                    <div *ngSwitchCase="03">
                                                        <ion-label color="dark" style="font-size: 14px;">{{MSG_CORRECTION}}</ion-label>
                                                    </div>
                                                    <div *ngSwitchCase="04">
                                                        <ion-label color="dark" style="font-size: 14px;">{{MSG_REPLACE}}</ion-label>
                                                    </div>
                                                    <div *ngSwitchCase="06">
                                                        <ion-label color="dark" style="font-size: 14px;">{{MSG_TROUBLE}}</ion-label>
                                                    </div>
                                                    <div *ngSwitchCase="07">
                                                        <ion-label color="dark" style="font-size: 14px;">{{MSG_CLEAN}}</ion-label>
                                                    </div>
                                                    <div *ngSwitchDefault>
                                                        <ion-label></ion-label>
                                                    </div>
                                                </ng-container>
                                            </ion-row>
                                        </ion-col>
                                        <ion-col>
                                            <ion-label text-right color="dark" class="sensor-value">{{ sensor.value }}</ion-label>
                                            &nbsp;{{ sensor.unit }}
                                        </ion-col>
                                    </ion-row>
                            </ion-card-content>     
                        </ion-card>

                        <ion-card *ngIf="(sensor.channel_id == channel.id) && (modes[i] == 3)" class="button-card" (click)="changeMode(i, 1)">
                            
                            <ion-card-content>
                                <ion-row>
                                    <ion-col align-self-end>
                                        <div echarts class="class-chart" [options]="optionValue" [merge]="updateOption[i]"></div>
                                    </ion-col>
                                    <ion-col>
                                        <ion-label text-right color="dark" class="sensor-value">{{ sensor.value }}</ion-label>
                                        &nbsp;{{ sensor.unit }}
                                    </ion-col>
                                </ion-row>
                            </ion-card-content>
                        </ion-card>
                    </ion-col>
                </ion-row>
                
            </ion-grid>
            </ion-slide>
        </ion-slides>
    
</ion-content>
